<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>SoundCloud Jukebox</title>
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="styles.css">
    <!-- font awesome library-->
    <link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
    <!-- Javascript Page -->
    <!--<script src="function.js" type="text/javascript"></script>-->
    <!-- jQuery Library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- SoundCloud API reference -->
    <script src="https://connect.soundcloud.com/sdk/sdk-3.3.0.js"></script>
    <script>
    SC.initialize({
        client_id: 'f665fc458615b821cdf1a26b6d1657f6',
        redirect_uri: 'http://example.com/callback'
    });
    </script>
</head>

<body>
    <!-- CSS Sheet-->
    <style type="text/css">

    </style>
    <header>
        <div class="welcome">
            <img src="http://moziru.com/images/fluffy-clipart-cloud-transparent-3.jpg">
            <div id="Funcbtns">
                <h1>
                Sound Cloud - <strong>a soundcloud streaming Site </strong>
            </h1>
            </div>
    </header>
    <div class="searchbar">
        <input type="text" id="input" placeholder="song, artist, album...">
    </div>
    <div class="button-obj">
        <button class="searchbutton" onclick="jukebox.search();">Search Trackname</button>
        <button class="searchbutton2" onclick="jukebox.playnext();">Play Next</button>
        <button class="searchbutton3" onclick="jukebox.searchtrackid();">Search by Track ID</button>
    </div>
    <button id="play" onclick="jukebox.play();">Play</button>
    <button id="pause" onclick="jukebox.pause();">Pause</button>
    <button id="stop " onclick="jukebox.stop(); "">Stop</button>
    </div>
    <div id="results-container">
        <div id="results-box">
            <p>Webpage URL</p>
            <p id="results-description">
                <strong> Search Results</strong>
            </p>
            <ol id="obj_results">
            </ol>
        </div>
        <!--<img src="">-->
    </div>
    <script type="text/javascript">
    
    var searchterm = null;
    var musicobject;
    var songs = [];
    var currentSong = 0;

    var jukebox = {
        search: function() {
            var searchterm = document.getElementById("input").value;
            SC.get("/tracks", {
                q: searchterm
            }).then(function(response) {
                musicobject = response;

                for (i = 0; i < musicobject.length; i++) {
                    console.log("hello");
                    console.log(musicobject[i]);
                    console.log(musicobject[i].id);
                    console.log(musicobject[i].title);
                    var trackid = musicobject[i].id;
                    trackname = musicobject[i].title;
                    var para = document.createElement('li');
                    var songinfo = document.createTextNode("Name of Track:" + " " + trackname);
                    document.getElementById("results-box").appendChild(para);
                    para.innerHTML = "<a id =\"" + trackid + "\" href=\"\">" + " Name of Track:" + trackname + "</a>"
                };
                
                console.log("parainnerhtml", para.innerHTML);
                
            });
            var generatedsongs = [document.querySelectorAll('results-box a')]
            generatedsongs.forEach(function() {
                addEventListener("click", function(event) { event.preventDefault() });
            });
            generatedsongs.forEach(function() {
                addEventListener("click", function(generatedsongs) {
                    
                    var generatedsongid = generatedsongs.path[0].id;
                    console.log("trackid", generatedsongid);
                    SC.stream('/tracks/' + generatedsongid).then(function(player) {
                        console.log(player);
                        player.play();

                    });



                });
            });

        },

        
        
        playnext: function playNext() {  
        SC.stream( '/tracks/' + songs[currentSong].id ).then(function(player){    player.play();    player.on("finish",function(){      
        currentSong += 1;       
        playNext();           
    });  
    });
    },


        pause: function pauseSong() {
            document.getElementById('pause').addEventListener('onclick')
            myPlayer.pause();
        }
    }
    </script>
   
</body>

</html>